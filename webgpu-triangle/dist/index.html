<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebGPU Triangle - Go WASM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="wasm_exec.js"></script>
    <style>
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-success {
            background-color: #28a745;
        }

        .status-warning {
            background-color: #ffc107;
        }

        .status-error {
            background-color: #dc3545;
        }

        .status-info {
            background-color: #17a2b8;
        }
    </style>
</head>

<body class="bg-gradient-to-br from-blue-50 to-purple-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <!-- Header -->
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-gray-800 mb-2">WebGPU Triangle Demo</h1>
                <p class="text-gray-600">Pure Go compiled to WebAssembly with WebGPU rendering</p>
            </div>

            <!-- Status Card -->
            <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-700">Status</h3>
                    <span class="status-indicator status-info" id="status-indicator"></span>
                </div>
                <div class="bg-gray-50 rounded-md p-3">
                    <span id="status-text">Initializing...</span>
                </div>
            </div>

            <!-- Canvas Container -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex flex-col items-center">
                    <h3 class="text-lg font-semibold text-gray-700 mb-4">WebGPU Triangle</h3>

                    <!-- Canvas -->
                    <div class="border-2 border-gray-200 rounded-lg overflow-hidden bg-gray-50">
                        <canvas id="webgpu-canvas" width="800" height="600" class="block"></canvas>
                    </div>

                    <!-- Controls -->
                    <div class="mt-4">
                        <button id="reinit-btn"
                            class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200"
                            onclick="location.reload()">
                            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                            </svg>
                            Reinitialize
                        </button>
                    </div>
                </div>
            </div>

            <!-- Info Card -->
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mt-6">
                <div class="flex">
                    <svg class="w-5 h-5 text-blue-400 mr-2 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd"
                            d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                            clip-rule="evenodd" />
                    </svg>
                    <div>
                        <h4 class="text-sm font-medium text-blue-800">About this demo</h4>
                        <p class="text-sm text-blue-700 mt-1">
                            This demonstrates WebGPU triangle rendering using pure Go compiled to WebAssembly.
                            The triangle is rendered using WebGPU's modern graphics API with vertex and fragment
                            shaders,
                            all orchestrated from Go code compiled to WASM.
                        </p>
                        <p class="text-sm text-blue-700 mt-2">
                            <strong>Requirements:</strong> Chrome with WebGPU enabled (use
                            <code>--enable-unsafe-webgpu</code> flag) or Chrome Canary.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const go = new Go();
        WebAssembly.instantiateStreaming(fetch("main.wasm"), go.importObject).then((result) => {
            go.run(result.instance);
        });
    </script>
</body>

</html>